<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conquistas e Recompensas - Conecta V√≥</title>

    <meta name="description" content="Acompanhe sua pontua√ß√£o, desbloqueie medalhas e troque seus pontos por recompensas exclusivas na plataforma de inclus√£o digital Conecta V√≥." />
    <meta name="keywords" content="conquistas, pontos, medalhas, recompensas, gamifica√ß√£o, idoso, Conecta V√≥, progresso" />
    <meta name="author" content="Conecta V√≥" />

    <link 
    rel="icon" 
    href="../assets/logo cvo.ico">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles/style.css">
</head>
<body>

    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1080;">
        </div>

    <header class="header-container bg-light py-2 shadow-sm d-flex flex-wrap justify-content-between align-items-center">
        <span class="text-muted fw-semibold fs-5 ms-5 d-none d-md-block">
            Tecnologia com carinho. Conectando gera√ß√µes.
        </span>

        <div id="user-controls" class="d-flex align-items-center ms-auto me-5 gap-3">
            <a href="entrar-cadastrar.html" id="link-login-header" title="Acesse sua conta ou crie um novo cadastro">
                <button class="btn btn-outline-secondary btn-sm fs-6">
                    Entrar / Cadastrar
                </button>
            </a>
            
            <div id="user-info-header" class="d-none align-items-center gap-2">
                <span class="text-teal fw-semibold fs-6" id="user-greeting" aria-live="polite">Ol√°, Usu√°rio!</span>
                <button id="btn-logout" class="btn btn-sm btn-outline-danger fs-6" title="Sair da sua conta">
                    Sair
                </button>
            </div>
        </div>
    </header>

    <nav class="navbar-principal shadow" style="background-color: #18a5a7; padding: 1.5rem 0;">
        <div class="container d-flex flex-wrap justify-content-between align-items-center">
            <a href="index.html" class="logo" title="Ir para a p√°gina inicial Conecta V√≥">
                <img src="../assets/logo.png" alt="Logo Conecta V√≥" height="80" />
            </a>

            <ul class="nav">
                <li class="nav-item">
                    <a class="nav-link text-white fw-semibold" href="index.html">In√≠cio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fw-semibold" href="sobre.html">Sobre</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fw-semibold" href="aulas.html">Aulas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fw-semibold" href="ajuda.html">Ajuda</a>
                </li>
            </ul>

            <div class="botoes-acao d-flex align-items-center gap-3 me-4">
                <a href="voluntario.html">
                    <button class="btn btn-voluntario" title="Torne-se um volunt√°rio e ajude a conectar gera√ß√µes">Seja Volunt√°rio</button>
                </a>
                <i
                    class="bi bi-search text-white busca-icon"
                    onclick="toggleBusca()"
                    title="Buscar conte√∫do na plataforma"
                    aria-label="Abrir campo de busca"
                ></i>
            </div>
        </div>
    </nav>

    <div id="campoBusca" class="container mt-3" style="display: none;">
        <form class="d-flex" onsubmit="buscarConteudo(event)" role="search">
            <input class="form-control me-2" type="search" placeholder="Buscar conte√∫do..." aria-label="Buscar conte√∫do no Conecta V√≥">
            <button class="btn btn-outline-success" type="submit" aria-label="Executar busca">Buscar</button>
        </form>
    </div>

    <main class="container py-5">
        <section class="text-center mb-5">
            <h1 class="main-title text-teal">Conquistas e Recompensas</h1>
            <p class="lead">Acompanhe seu progresso, celebre suas conquistas e resgate pr√™mios especiais.</p>
        </section>

        <section class="mb-5" aria-labelledby="pontuacaoTitulo">
            <div class="card p-4 text-center shadow-sm">
                <div class="d-flex justify-content-center align-items-center">
                    <i class="bi bi-star-fill text-warning me-2" style="font-size: 2rem;" aria-hidden="true"></i>
                    <h2 id="pontuacaoTitulo" class="mb-0 fs-3">Sua Pontua√ß√£o: <span class="text-teal" id="user-points">0</span></h2>
                    <a href="#" data-bs-toggle="modal" data-bs-target="#modalPontuacao" class="ms-2" aria-label="Entender como funciona a pontua√ß√£o">
                        <i class="bi bi-info-circle text-muted" style="font-size: 1.5rem; cursor: pointer;" title="Entenda como funciona a pontua√ß√£o"></i>
                    </a>
                </div>
            </div>
        </section>

        <section class="mb-5" aria-labelledby="medalhasTitulo">
            <h3 id="medalhasTitulo" class="text-center mb-4">Suas Medalhas</h3>

            <div id="mensagemMedalhas" class="text-center p-4">
                <p class="lead">Fa√ßa <a href="entrar-cadastrar.html" class="text-teal text-decoration-none fw-semibold">login</a> para ver seu progresso, medalhas e pontos.</p>
                <button id="btnMostrarMedalhas" class="btn btn-verde mt-3" style="display: none;">Visualizar Todas as Medalhas</button>
            </div>

            <div id="secaoMedalhas" style="display: none;">
                <h4 class="text-center mb-3 text-success">Medalhas F√°ceis</h4>
                <div class="row g-4 justify-content-center mb-5">
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="/assets/conquista_Primeiro_Login.png" aria-label="Medalha Primeiro Login. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Primeiro Login" data-pontos="50"
                                data-requisito="Basta acessar a plataforma e realizar seu primeiro login para ganhar essa medalha.">
                                <img src="/assets/conquista_Primeiro_Login.png" alt="√çcone da Medalha Primeiro Login" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Primeiro Login</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Primeiro Coment√°rio. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Primeiro Coment√°rio" data-pontos="50"
                                data-requisito="Deixe seu primeiro coment√°rio em qualquer aula ou postagem da comunidade para mostrar que voc√™ est√° interagindo.">
                                <img src="/assets/conquista_primeiro_comentario.png" alt="√çcone da Medalha Primeiro Coment√°rio" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Primeiro Coment√°rio</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Primeiro Contato. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Primeiro Contato" data-pontos="50"
                                data-requisito="Envie sua primeira mensagem para um volunt√°rio ou outro usu√°rio da plataforma.">
                                <img src="/assets/conquista_primeiro_contato.png" alt="√çcone da Medalha Primeiro Contato" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Primeiro Contato</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Explorador do Conhecimento. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Explorador do Conhecimento" data-pontos="50"
                                data-requisito="Conclua a sua primeira aula de introdu√ß√£o √† tecnologia.">
                                <img src="/assets/conquista_Explorador_do_Conhecimento.png" alt="√çcone da Medalha Explorador do Conhecimento" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Explorador do Conhecimento</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Aventureiro do Telefone. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Aventureiro do Telefone" data-pontos="50"
                                data-requisito="Finalize a aula sobre como usar o telefone para realizar chamadas e mensagens.">
                                <img src="/assets/conquista_Aventureiro_do_Telefone.png" alt="√çcone da Medalha Aventureiro do Telefone" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Aventureiro do Telefone</p>
                            </div>
                        </a>
                    </div>
                </div>

                <h4 class="text-center mb-3 text-info">Medalhas M√©dias</h4>
                <div class="row g-4 justify-content-center mb-5">
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Explorador da Web. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Explorador da Web" data-pontos="150"
                                data-requisito="Navegue por 5 sites diferentes, incluindo um site de not√≠cias e um de receitas.">
                                <img src="/assets/conquista_esxplorador_web.png" alt="√çcone da Medalha Explorador da Web" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Explorador da Web</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Guardi√£o da Seguran√ßa. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Guardi√£o da Seguran√ßa" data-pontos="150"
                                data-requisito="Complete o curso sobre seguran√ßa online e privacidade de dados para proteger suas informa√ß√µes.">
                                <img src="/assets/conquista_Guardi√£o_da_Seguran√ßa.png" alt="√çcone da Medalha Guardi√£o da Seguran√ßa" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Guardi√£o da Seguran√ßa</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Amigo da Tecnologia. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Amigo da Tecnologia" data-pontos="150"
                                data-requisito="Responda a 3 perguntas de outros usu√°rios ou volunt√°rios na se√ß√£o de ajuda.">
                                <img src="/assets/conquista_Amigo_ da_Tecnologia.png" alt="√çcone da Medalha Amigo da Tecnologia" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Amigo da Tecnologia</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Ouvinte Ativo. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Ouvinte Ativo" data-pontos="150"
                                data-requisito="Assista a 5 aulas completas sobre diferentes t√≥picos.">
                                <img src="/assets/conquista_ouvinte_ativo.png" alt="√çcone da Medalha Ouvinte Ativo" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Ouvinte Ativo</p>
                            </div>
                        </a>
                    </div>
                </div>

                <h4 class="text-center mb-3 text-warning">Medalhas Dif√≠ceis</h4>
                <div class="row g-4 justify-content-center mb-5">
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Mestre das Compras. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Mestre das Compras" data-pontos="500"
                                data-requisito="Conclua a aula sobre compras online e fa√ßa sua primeira compra segura.">
                                <img src="/assets/conquista_mestre_das_compras.png" alt="√çcone da Medalha Mestre das Compras" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Mestre das Compras</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Conectado com a Fam√≠lia. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Conectado com a Fam√≠lia" data-pontos="500"
                                data-requisito="Realize uma chamada de v√≠deo com um familiar ou amigo usando um aplicativo de mensagens.">
                                <img src="/assets/conquista_Conect_ado com_a_Fam√≠lia.png" alt="√çcone da Medalha Conectado com a Fam√≠lia" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Conectado com a Fam√≠lia</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Guru do Telefone. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Guru do Telefone" data-pontos="500"
                                data-requisito="Domine as fun√ß√µes avan√ßadas do smartphone, como gerenciar aplicativos e organizar fotos.">
                                <img src="/assets/conquistas_guru_telefone.png" alt="√çcone da Medalha Guru do Telefone" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Guru do Telefone</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Conectado com o Mundo. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Conectado com o Mundo" data-pontos="500"
                                data-requisito="Assine um boletim informativo de not√≠cias ou siga um perfil de interesse nas redes sociais.">
                                <img src="/assets/conquista_Conectado_ com_o_Mundo.png" alt="√çcone da Medalha Conectado com o Mundo" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Conectado com o Mundo</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Criador de Conte√∫do. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Criador de Conte√∫do" data-pontos="500"
                                data-requisito="Publique sua primeira receita, hist√≥ria ou foto na comunidade.">
                                <img src="/assets/conquista_Criador de_Conte√∫do.png" alt="√çcone da Medalha Criador de Conte√∫do" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Criador de Conte√∫do</p>
                            </div>
                        </a>
                    </div>
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Mestre da Videochamada. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Mestre da Videochamada" data-pontos="500"
                                data-requisito="Participe de 3 videochamadas em grupo com amigos ou familiares.">
                                <img src="/assets/conquista_Mestre_da_ Videochamada.png" alt="√çcone da Medalha Mestre da Videochamada" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Mestre da Videochamada</p>
                            </div>
                        </a>
                    </div>
                </div>

                <h4 class="text-center mb-3 text-danger">Medalha √Åpice</h4>
                <div class="row g-4 justify-content-center">
                    <div class="col-6 col-md-4 col-lg-2">
                        <a href="#" aria-label="Medalha Guardi√£o da Conex√£o. Bloqueada." data-bs-toggle="modal" data-bs-target="#modalConquista">
                            <div class="conquista-medalha bloqueada text-center"
                                data-conquista="Guardi√£o da Conex√£o" data-pontos="2000"
                                data-requisito="Conquiste todas as medalhas das categorias F√°cil, M√©dia e Dif√≠cil.">
                                <img src="/assets/conquista_guardiao_conexao.png" alt="√çcone da Medalha Guardi√£o da Conex√£o" class="img-fluid conquista-icon">
                                <p class="conquista-nome">Guardi√£o da Conex√£o</p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-5" aria-labelledby="resgateTitulo">
            <h3 id="resgateTitulo" class="text-center mb-4">Troque seus Pontos</h3>
            <div class="row g-4 justify-content-center">
                <div class="col-6 col-md-4 col-lg-3">
                    <div class="card h-100 text-center p-3 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-gift" style="font-size: 3rem; color: #18a5a7;" aria-hidden="true"></i>
                            <h5 class="card-title mt-3">Aula Particular Gratuita</h5>
                            <p class="card-text">Troque 500 pontos por uma aula extra.</p>
                            <button class="btn btn-verde w-100" onclick="handleResgate(500, 'Aula Particular')" aria-label="Resgatar Aula Particular por 500 pontos">Resgatar</button>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-4 col-lg-3">
                    <div class="card h-100 text-center p-3 shadow-sm">
                        <div class="card-body">
                            <i class="bi bi-trophy" style="font-size: 3rem; color: #18a5a7;" aria-hidden="true"></i>
                            <h5 class="card-title mt-3">Selo de Mestre Conecta</h5>
                            <p class="card-text">Troque 1000 pontos por um selo especial.</p>
                            <button class="btn btn-verde w-100" onclick="handleResgate(1000, 'Selo Mestre')" aria-label="Resgatar Selo de Mestre Conecta por 1000 pontos">Resgatar</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-teal text-white py-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4 text-center text-md-start mb-4 mb-md-0">
                    <a href="index.html" class="d-inline-block mb-3" title="Voltar para o In√≠cio">
                        <img src="../assets/logo.png" alt="Logo Conecta V√≥" height="80" />
                    </a>
                    <p class="mb-0">Tecnologia com carinho. Conectando gera√ß√µes.</p>
                </div>
                <div class="col-md-4 text-center mb-4 mb-md-0">
                    <h5>Navega√ß√£o</h5>
                    <ul class="list-unstyled d-flex flex-column flex-md-row justify-content-center gap-3">
                        <li><a href="index.html" class="text-white text-decoration-none">In√≠cio</a></li>
                        <li><a href="sobre.html" class="text-white text-decoration-none">Sobre</a></li>
                        <li><a href="aulas.html" class="text-white text-decoration-none">Aulas</a></li>
                        <li><a href="ajuda.html" class="text-white text-decoration-none">Ajuda</a></li>
                    </ul>
                </div>
                <div class="col-md-4 text-center text-md-end">
                    <h5>Siga-nos</h5>
                    <a href="#" class="social-icon text-white me-3" target="_blank" rel="noopener noreferrer" aria-label="Siga-nos no Facebook"><i class="bi bi-facebook"></i></a>
                    <a href="#" class="social-icon text-white me-3" target="_blank" rel="noopener noreferrer" aria-label="Siga-nos no Instagram"><i class="bi bi-instagram"></i></a>
                    <a href="#" class="social-icon text-white" target="_blank" rel="noopener noreferrer" aria-label="Siga-nos no Twitter"><i class="bi bi-twitter"></i></a>
                </div>
            </div>
            <hr class="mt-4 mb-3 border-light">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">Copyright ¬© 2025 Conecta V√≥. Todos os direitos reservados.</p>
                </div>
            </div>
        </div>
    </footer>

    <div class="modal fade" id="modalConquista" tabindex="-1" aria-labelledby="modalConquistaTitulo" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content text-center p-4">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">
                <img id="modalConquistaImagem" src="" alt="√çcone da Conquista" class="img-fluid mb-3" style="max-height: 120px;">
                
                <h4 class="mt-3" id="modalConquistaTitulo">Conquista Desbloqueada!</h4>
                <h6 class="text-muted" id="modalConquistaPontos"></h6>
                
                <p class="lead" id="modalConquistaDescricao"></p>
                
                <a id="btnDownloadMedalha" href="#" download="medalha.png" class="btn btn-teal mt-3 d-none">
                    <i class="bi bi-download me-2"></i> Baixar Imagem da Medalha
                </a>
            </div>
        </div>
    </div>
</div>
    
    <div class="modal fade" id="modalPontuacao" tabindex="-1" aria-labelledby="modalPontuacaoLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content p-4">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title" id="modalPontuacaoLabel">Como Funciona a Pontua√ß√£o</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <div class="modal-body">
                    <p>Cada conquista que voc√™ desbloqueia concede uma quantidade de pontos, que varia de acordo com o n√≠vel de dificuldade da atividade:</p>
                    <ul class="list-unstyled">
                        <li><span class="fw-bold text-success">Miss√µes F√°ceis:</span> 50 pontos</li>
                        <li><span class="fw-bold text-info">Miss√µes M√©dias:</span> 150 pontos</li>
                        <li><span class="fw-bold text-warning">Miss√µes Dif√≠ceis:</span> 500 pontos</li>
                        <li><span class="fw-bold text-danger">Medalha √Åpice:</span> 2000 pontos</li>
                    </ul>
                    <p class="mb-0 mt-3">Quanto mais voc√™ aprende e interage, mais pontos voc√™ ganha!</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous">
    </script>

    <script>
        // --- Vari√°veis Globais (Local Storage Keys) ---
        const LOGGED_KEY = 'conectaVo_logged';
        const USER_NAME_KEY = 'conectaVo_userName';
        const USER_POINTS_KEY = 'conectaVo_userPoints';
        const ACHIEVEMENT_KEY = 'conectaVo_achievements';
        
        // Mapeamento de conquistas para facilitar a gest√£o de estados
        const allAchievements = [
            // F√°ceis
            { id: 'Primeiro Login', points: 50, category: 'Facil' },
            { id: 'Primeiro Coment√°rio', points: 50, category: 'Facil' },
            { id: 'Primeiro Contato', points: 50, category: 'Facil' },
            { id: 'Explorador do Conhecimento', points: 50, category: 'Facil' },
            { id: 'Aventureiro do Telefone', points: 50, category: 'Facil' },
            // M√©dias
            { id: 'Explorador da Web', points: 150, category: 'Media' },
            { id: 'Guardi√£o da Seguran√ßa', points: 150, category: 'Media' },
            { id: 'Amigo da Tecnologia', points: 150, category: 'Media' },
            { id: 'Ouvinte Ativo', points: 150, category: 'Media' },
            // Dif√≠ceis
            { id: 'Mestre das Compras', points: 500, category: 'Dificil' },
            { id: 'Conectado com a Fam√≠lia', points: 500, category: 'Dificil' },
            { id: 'Guru do Telefone', points: 500, category: 'Dificil' },
            { id: 'Conectado com o Mundo', points: 500, category: 'Dificil' },
            { id: 'Criador de Conte√∫do', points: 500, category: 'Dificil' },
            { id: 'Mestre da Videochamada', points: 500, category: 'Dificil' },
            // √Åpice
            { id: 'Guardi√£o da Conex√£o', points: 2000, category: 'Apice' }
        ];

        // --- Fun√ß√µes de Feedback (Toast) ---

        function showToast(message, type = 'success') {
            const toastContainer = document.querySelector('.toast-container');
            if (!toastContainer) return; 
            
            // Cria um novo elemento Toast do zero
            const newToastEl = document.createElement('div');
            newToastEl.classList.add('toast', 'align-items-center', 'text-white', 'border-0');
            newToastEl.classList.add(`bg-${type}`);
            newToastEl.setAttribute('role', 'alert');
            newToastEl.setAttribute('aria-live', 'assertive');
            newToastEl.setAttribute('aria-atomic', 'true');
            newToastEl.setAttribute('data-bs-delay', '5000');

            newToastEl.innerHTML = `
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Fechar notifica√ß√£o"></button>
                </div>
            `;
            
            toastContainer.appendChild(newToastEl);
            // Inicializa o toast
            const toast = new bootstrap.Toast(newToastEl);
            toast.show();

            newToastEl.addEventListener('hidden.bs.toast', () => {
                newToastEl.remove();
            });
        }
        
        // --- Fun√ß√µes de Estado (Checagem e Atualiza√ß√£o do Header) ---

        function updateHeaderState() {
            const loggedIn = localStorage.getItem(LOGGED_KEY) === 'true';
            const userName = localStorage.getItem(USER_NAME_KEY);
            const userPoints = localStorage.getItem(USER_POINTS_KEY) || '0'; 

            const loginLink = document.getElementById('link-login-header');
            const userInfoHeader = document.getElementById('user-info-header');
            const userGreeting = document.getElementById('user-greeting');
            const pointsDisplay = document.getElementById('user-points');
            const btnLogout = document.getElementById('btn-logout');

            if (loggedIn && userName) {
                // Estado Logado
                if (loginLink) loginLink.classList.add('d-none');
                if (userInfoHeader) {
                    userInfoHeader.classList.remove('d-none');
                    userInfoHeader.classList.add('d-flex');
                }
                if (userGreeting) userGreeting.textContent = `Ol√°, ${userName}!`;
                
                // Atualiza os pontos na se√ß√£o principal
                if (pointsDisplay) pointsDisplay.textContent = userPoints;

                // Adiciona o evento de Logout
                if (btnLogout) {
                    btnLogout.removeEventListener('click', handleLogout); // Preven√ß√£o de duplica√ß√£o
                    btnLogout.addEventListener('click', handleLogout);
                }
            } else {
                // Estado Deslogado
                if (loginLink) loginLink.classList.remove('d-none');
                if (userInfoHeader) {
                    userInfoHeader.classList.add('d-none');
                    userInfoHeader.classList.remove('d-flex');
                }
                if (pointsDisplay) pointsDisplay.textContent = '0'; // Zera pontos se deslogado
            }
        }

        function handleLogout() {
            localStorage.setItem(LOGGED_KEY, 'false');
            localStorage.removeItem(USER_NAME_KEY);
            localStorage.setItem(USER_POINTS_KEY, 0); // Zera os pontos no logout
            localStorage.removeItem(ACHIEVEMENT_KEY); // Remove as conquistas no logout
            showToast('Voc√™ saiu da sua conta. Volte logo!', 'info');
            updateHeaderState();
            updateAchievementsDisplay(); // Atualiza a exibi√ß√£o de medalhas e pontos
        }

        // --- Fun√ß√µes de Conquistas e Pontua√ß√£o (Gamifica√ß√£o) ---
        
        /**
         * Concede uma conquista ao usu√°rio, adiciona os pontos e atualiza o estado.
         * @param {string} achievementId - O ID da conquista (Ex: 'Primeiro Coment√°rio').
         */
        function grantAchievement(achievementId) {
            const loggedIn = localStorage.getItem(LOGGED_KEY) === 'true';
            if (!loggedIn) {
                showToast('Fa√ßa login para come√ßar a ganhar conquistas e pontos!', 'warning');
                return false;
            }

            const storedAchievements = JSON.parse(localStorage.getItem(ACHIEVEMENT_KEY)) || {};
            if (storedAchievements[achievementId]) {
                // A conquista j√° foi concedida
                return true; 
            }

            const achievement = allAchievements.find(a => a.id === achievementId);

            if (achievement) {
                // 1. Marca a conquista como feita
                storedAchievements[achievementId] = true;
                localStorage.setItem(ACHIEVEMENT_KEY, JSON.stringify(storedAchievements));
                
                // 2. Adiciona os pontos
                const currentPoints = parseInt(localStorage.getItem(USER_POINTS_KEY)) || 0;
                const newPoints = currentPoints + achievement.points;
                localStorage.setItem(USER_POINTS_KEY, newPoints);
                
                // 3. Atualiza o display e d√° feedback
                updateHeaderState();
                updateAchievementsDisplay();
                showToast(`üéâ Conquista Desbloqueada! Voc√™ ganhou "${achievement.id}" e ${achievement.points} pontos!`, 'success');
                return true;
            }
            return false;
        }

        function calculateAndSetTotalPoints(currentAchievements) {
            let totalPoints = 0;
            for (const achievement of allAchievements) {
                if (currentAchievements[achievement.id]) {
                    totalPoints += achievement.points;
                }
            }
            localStorage.setItem(USER_POINTS_KEY, totalPoints);
            const pointsDisplay = document.getElementById('user-points');
            if (pointsDisplay) pointsDisplay.textContent = totalPoints;
            return totalPoints;
        }

        function initializeAchievements() {
            const storedAchievements = JSON.parse(localStorage.getItem(ACHIEVEMENT_KEY)) || {};
            
            // Simula a conquista "Primeiro Login" se o usu√°rio estiver logado, 
            // mas a conquista ainda n√£o foi registrada.
            if (localStorage.getItem(LOGGED_KEY) === 'true' && !storedAchievements['Primeiro Login']) {
                // Chamamos a nova fun√ß√£o de concess√£o de conquista
                grantAchievement('Primeiro Login');
                // IMPORTANTE: O grantAchievement j√° chama updateHeaderState e updateAchievementsDisplay
                return;
            }
            
            // Garante que a pontua√ß√£o total do usu√°rio √© a soma dos pontos das medalhas conquistadas
            calculateAndSetTotalPoints(storedAchievements);
            updateAchievementsDisplay(); // Atualiza a exibi√ß√£o visual
        }
function updateAchievementsDisplay() {
    const storedAchievements = JSON.parse(localStorage.getItem(ACHIEVEMENT_KEY)) || {};
    const loggedIn = localStorage.getItem(LOGGED_KEY) === 'true';

    const allMedalDivs = document.querySelectorAll('.conquista-medalha');
    let hasAchievedAny = false;

    // --- PARTE 1: ATUALIZA O ESTADO VISUAL DE CADA MEDALHA (MANTIDA) ---
    allMedalDivs.forEach(div => {
        const achievementName = div.getAttribute('data-conquista');
        
        // Garante que o estado visual das medalhas est√° sincronizado
        if (loggedIn && storedAchievements[achievementName]) {
            div.classList.add('conquistada');
            div.classList.remove('bloqueada');
            hasAchievedAny = true;
        } else {
            // Se n√£o est√° logado ou n√£o conquistou
            div.classList.remove('conquistada');
            div.classList.add('bloqueada');
        }

        // Gerencia o link de download/modal (MANTIDO)
        const link = div.closest('a');
        if (link) {
            if (div.classList.contains('conquistada')) {
                // Remove o download, pois a fun√ß√£o do modal √© melhor
                link.removeAttribute('download'); 
                link.setAttribute('aria-label', `Medalha ${achievementName}. Clique para ver detalhes e baixar.`);
            } else {
                link.removeAttribute('download');
                link.setAttribute('aria-label', `Medalha ${achievementName}. Bloqueada.`);
                link.href = '#'; 
            }
        }
    });
    
    // --- PARTE 2: GERENCIA A VISIBILIDADE DA SE√á√ÉO (REFINADA) ---
    const msgMedalhas = document.getElementById('mensagemMedalhas');
    const secaoMedalhas = document.getElementById('secaoMedalhas');
    const btnMostrar = document.getElementById('btnMostrarMedalhas');

    if (loggedIn) {
        // Logado: O bot√£o sempre aparece para logados
        btnMostrar.style.display = 'block'; 

        // Se o usu√°rio tem conquistas, a se√ß√£o deve iniciar vis√≠vel.
        if (hasAchievedAny) {
            msgMedalhas.style.display = 'none';
            secaoMedalhas.style.display = 'block';
            btnMostrar.textContent = 'Ocultar Todas as Medalhas';
        } else {
            // Logado, mas sem medalhas.
            msgMedalhas.style.display = 'block';
            secaoMedalhas.style.display = 'none';
            msgMedalhas.innerHTML = '<p class="lead">Parece que voc√™ ainda n√£o conquistou nenhuma medalha! Continue explorando e aprendendo para desbloquear sua primeira conquista.</p>';
            btnMostrar.textContent = 'Visualizar Todas as Medalhas';
        }

        // L√≥gica de altern√¢ncia (toggle) do bot√£o
        btnMostrar.onclick = () => {
            if (secaoMedalhas.style.display === 'block') {
                secaoMedalhas.style.display = 'none';
                msgMedalhas.style.display = 'block';
                // Mensagem customizada ao ocultar
                msgMedalhas.innerHTML = '<p class="lead">Continue explorando e aprendendo para desbloquear mais conquistas!</p>'; 
                btnMostrar.textContent = 'Visualizar Todas as Medalhas';
            } else {
                secaoMedalhas.style.display = 'block';
                msgMedalhas.style.display = 'none';
                btnMostrar.textContent = 'Ocultar Todas as Medalhas';
            }
        };

    } else {
        // Deslogado: Esconde a se√ß√£o, mostra a mensagem adaptada.
        msgMedalhas.style.display = 'block';
        secaoMedalhas.style.display = 'none';
        btnMostrar.style.display = 'none';
        msgMedalhas.innerHTML = '<p class="lead">Fa√ßa <a href="entrar-cadastrar.html" class="text-teal text-decoration-none fw-semibold">login</a> para ver seu progresso, medalhas e pontos.</p>';
    }
}
        // --- Fun√ß√µes de Modal (Exibi√ß√£o de Conquistas) ---

document.addEventListener('DOMContentLoaded', () => {
    const modalConquistaEl = document.getElementById('modalConquista');
    if (modalConquistaEl) {
        modalConquistaEl.addEventListener('show.bs.modal', function (event) {
            
            // Bot√£o que acionou o modal (o elemento <a>)
            const relatedTarget = event.relatedTarget; 
            const achievementDiv = relatedTarget.querySelector('.conquista-medalha');

            // Pega os dados do atributo data
            const nomeConquista = achievementDiv.getAttribute('data-conquista');
            const pontos = achievementDiv.getAttribute('data-pontos');
            const requisito = achievementDiv.getAttribute('data-requisito');
            const isConquistada = achievementDiv.classList.contains('conquistada');
            
            // Pega o caminho da imagem do <img> dentro do <div>
            const imagePath = achievementDiv.querySelector('img').src; 

            // Elementos do modal
            const modalTitle = modalConquistaEl.querySelector('#modalConquistaTitulo');
            const modalPontos = modalConquistaEl.querySelector('#modalConquistaPontos');
            const modalDescricao = modalConquistaEl.querySelector('#modalConquistaDescricao');
            
            // NOVO: Elementos de imagem e download
            const modalIcon = modalConquistaEl.querySelector('#modalConquistaImagem');
            const btnDownload = modalConquistaEl.querySelector('#btnDownloadMedalha');

            // Preenche o modal
            modalIcon.src = imagePath; // Atualiza a imagem

            if (isConquistada) {
                modalTitle.textContent = `${nomeConquista} - CONQUISTADA!`;
                modalTitle.classList.remove('text-danger');
                modalTitle.classList.add('text-teal');
                modalPontos.textContent = `Voc√™ ganhou ${pontos} pontos.`;
                modalDescricao.textContent = `Parab√©ns! Requisito: ${requisito}`;
                
                // Exibe e configura o bot√£o de download
                btnDownload.classList.remove('d-none');
                btnDownload.href = imagePath; 
                btnDownload.setAttribute('download', `Conquista_${nomeConquista.replace(/ /g, '_')}.png`);

            } else {
                modalTitle.textContent = `${nomeConquista} - Bloqueada`;
                modalTitle.classList.add('text-danger');
                modalTitle.classList.remove('text-teal');
                modalPontos.textContent = `Pontos: ${pontos} pontos.`;
                modalDescricao.textContent = `Para desbloquear, voc√™ precisa: ${requisito}`;
                
                // Esconde o bot√£o de download
                btnDownload.classList.add('d-none');
            }
        });
    }
});

        // --- Fun√ß√µes de Resgate de Pr√™mios ---

        function handleResgate(cost, rewardName) {
            const loggedIn = localStorage.getItem(LOGGED_KEY) === 'true';
            const currentPoints = parseInt(localStorage.getItem(USER_POINTS_KEY)) || 0;
            
            if (!loggedIn) {
                showToast('Voc√™ precisa estar logado para resgatar pr√™mios.', 'danger');
                return;
            }

            if (currentPoints >= cost) {
                const newPoints = currentPoints - cost;
                localStorage.setItem(USER_POINTS_KEY, newPoints);
                
                // Atualiza a exibi√ß√£o de pontos
                const pointsDisplay = document.getElementById('user-points');
                if (pointsDisplay) pointsDisplay.textContent = newPoints;
                updateHeaderState();

                showToast(`Parab√©ns! Voc√™ resgatou "${rewardName}". Seus novos pontos s√£o: ${newPoints}.`, 'success');

                // L√≥gica adicional de resgate (ex: enviar email, marcar como resgatado no back-end)
            } else {
                showToast(`Voc√™ precisa de ${cost} pontos para resgatar "${rewardName}". Faltam ${cost - currentPoints} pontos.`, 'warning');
            }
        }

        // --- Outras Fun√ß√µes (Busca) ---

        function toggleBusca() {
            const campoBusca = document.getElementById('campoBusca');
            if (campoBusca.style.display === 'none') {
                campoBusca.style.display = 'block';
            } else {
                campoBusca.style.display = 'none';
            }
        }

        function buscarConteudo(event) {
            event.preventDefault();
            const searchTerm = event.target.querySelector('input').value.trim();
            
            if (searchTerm) {
                showToast(`Buscando por: "${searchTerm}"... (Funcionalidade de busca simulada)`, 'info');
                // Implementar redirecionamento ou l√≥gica de busca real aqui
            } else {
                showToast('Por favor, digite algo para buscar.', 'warning');
            }
        }
        
        // --- FUN√á√ÉO DE TESTE PARA CONCEDER O PRIMEIRO COMENT√ÅRIO ---

        // Esta fun√ß√£o deve ser chamada sempre que um coment√°rio for postado
        function simularComentarioFeito() {
            // Chamamos a fun√ß√£o de concess√£o de conquista com o ID da medalha
            grantAchievement('Primeiro Coment√°rio');
        }


        // --- Inicializa√ß√£o da P√°gina ---
        document.addEventListener('DOMContentLoaded', () => {
            // SIMULA√á√ÉO DE LOGIN para fins de teste
            if (!localStorage.getItem(LOGGED_KEY)) {
                localStorage.setItem(LOGGED_KEY, 'true'); 
                localStorage.setItem(USER_NAME_KEY, 'Dona Maria');
                localStorage.setItem(USER_POINTS_KEY, 0); 
            }
            
            updateHeaderState(); 
            initializeAchievements();
        });
    </script>
</body>
</html>